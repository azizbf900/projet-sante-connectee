<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.control.ProgressIndicator?>

<?import java.net.URL?>
<AnchorPane prefHeight="600.0" prefWidth="800.0" xmlns="http://javafx.com/javafx/11.0.1"
            xmlns:fx="http://javafx.com/fxml/1" fx:controller="controllers.FrontProduit">
    <stylesheets>
        <URL value="@../styles/styles.css"/>
    </stylesheets>

    <VBox alignment="TOP_CENTER" prefHeight="600.0" prefWidth="800.0"
          AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0"
          AnchorPane.topAnchor="0.0">
        <HBox alignment="CENTER" styleClass="header-box">
            <Label fx:id="lblHeaderTitle" text="Produits MÃ©dicaux" styleClass="header-label">
                <font>
                    <Font name="System Bold" size="24.0"/>
                </font>
                <padding>
                    <Insets bottom="15.0" left="15.0" right="15.0" top="15.0"/>
                </padding>
            </Label>
        </HBox>

        <!-- Search and Filter Section -->
        <VBox styleClass="search-section" spacing="10">
            <HBox alignment="CENTER_LEFT" spacing="10" styleClass="search-box">
                <Label text="Filtrer par:" styleClass="filter-label"/>
                <ComboBox fx:id="categorieComboBox" styleClass="filter-combo" prefWidth="200.0"
                          promptText="Toutes les catÃ©gories"/>

                <!-- Price Range Filter -->
                <Label text="Prix:" styleClass="filter-label"/>
                <TextField fx:id="minPriceField" styleClass="price-field" prefWidth="100.0"
                           promptText="Min â‚¬"/>
                <Label text="-" styleClass="filter-label"/>
                <TextField fx:id="maxPriceField" styleClass="price-field" prefWidth="100.0"
                           promptText="Max â‚¬"/>

                <Region HBox.hgrow="ALWAYS"/>
                <TextField fx:id="searchField" styleClass="search-field" prefWidth="200.0"
                           promptText="Rechercher..."/>
                <Button fx:id="btnSearch" mnemonicParsing="false" onAction="#handleSearch"
                        styleClass="action-button" text="Rechercher"/>
                <Button fx:id="voiceSearchButton" text="ðŸŽ¤" onAction="#handleVoiceSearch"
                        styleClass="voice-button"/>
            </HBox>

            <!-- Price Range Slider -->
            <HBox alignment="CENTER" spacing="10" styleClass="slider-box">
                <Label fx:id="priceRangeLabel" text="Gamme de prix: 0â‚¬ - 100â‚¬" styleClass="filter-label"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button fx:id="btnResetPrice" text="RÃ©initialiser" onAction="#resetPriceFilter"
                        styleClass="reset-button"/>
            </HBox>
            <HBox alignment="CENTER" spacing="10">
                <Label text="0â‚¬" styleClass="price-label"/>
                <Slider fx:id="priceRangeSlider" min="0" max="100" value="100"
                        showTickLabels="false" showTickMarks="true" majorTickUnit="100"
                        blockIncrement="10" styleClass="price-slider"/>
                <Label text="100â‚¬" styleClass="price-label"/>
            </HBox>
        </VBox>

        <Label fx:id="lblResultInfo" text="Affichage de tous les produits" styleClass="subtitle-label">
            <VBox.margin>
                <Insets bottom="10.0" left="20.0" right="20.0" top="10.0"/>
            </VBox.margin>
        </Label>

        <ScrollPane fitToWidth="true" styleClass="products-scroll-pane" VBox.vgrow="ALWAYS">
            <FlowPane fx:id="produitsContainer" styleClass="products-flow-pane"
                      hgap="20" vgap="20" alignment="CENTER">
                <padding>
                    <Insets bottom="20.0" left="20.0" right="20.0" top="20.0"/>
                </padding>
            </FlowPane>
        </ScrollPane>

        <HBox alignment="CENTER" spacing="20" styleClass="footer-box">
            <Button fx:id="btnRetourCategories" mnemonicParsing="false"
                    onAction="#handleRetourCategories" styleClass="back-button"
                    text="Retour aux catÃ©gories">
                <graphic>
                    <ImageView fitHeight="20" fitWidth="20">
                        <Image url="@../images/back-arrow.png"/>
                    </ImageView>
                </graphic>
            </Button>
            <Button fx:id="btnAccueil" mnemonicParsing="false"
                    onAction="#handleRetourAccueil" styleClass="home-button"
                    text="Accueil">
                <graphic>
                    <ImageView fitHeight="20" fitWidth="20">
                        <Image url="@../images/home-icon.png"/>
                    </ImageView>
                </graphic>
            </Button>
        </HBox>
    </VBox>

    <!-- Voice Recognition Overlay -->
    <StackPane fx:id="voiceRecognitionOverlay" visible="false" styleClass="overlay-pane"
               managed="${voiceRecognitionOverlay.visible}" AnchorPane.bottomAnchor="0.0"
               AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
        <VBox alignment="CENTER" spacing="15" styleClass="overlay-content">
            <Label text="Ã‰coute en cours..." styleClass="overlay-title"/>
            <ProgressIndicator styleClass="overlay-progress"/>
            <Label fx:id="voicePromptLabel" styleClass="overlay-prompt"
                   text="Dites le nom du produit Ã  rechercher..."/>
            <Button text="Annuler" onAction="#cancelVoiceRecognition" styleClass="overlay-button"/>
        </VBox>
    </StackPane>
</AnchorPane>